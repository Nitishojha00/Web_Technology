<!DOCTYPE html>
<html>
<head>
  <title>Task Scheduler</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 500px;
      margin: 50px auto;
      padding: 20px;
      background-color: #f4f4f4;
      border-radius: 10px;
    }
    h2 {
      text-align: center;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin: 5px 0;
      font-size: 16px;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: white;
      padding: 10px;
      margin: 5px 0;
      border-left: 4px solid green;
    }
    .actions {
      margin-top: 5px;
    }
    .actions button {
      margin-right: 5px;
      font-size: 14px;
      padding: 5px;
    }
  </style>
</head>
<body>

  <h2>üóìÔ∏è Task Scheduler</h2>

  <input id="taskInput" type="text" placeholder="Enter task title">
  <input id="timeInput" type="datetime-local">
  <button onclick="addTask()">Add Task</button>

  <ul id="taskList"></ul>

  <!-- Alarm sound -->
  <audio id="alarmSound" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg"></audio>

  <script>
    var tasks = [];

    if (localStorage.getItem("savedTasks")) {
      tasks = JSON.parse(localStorage.getItem("savedTasks"));
    }

    function saveTasks() {
      localStorage.setItem("savedTasks", JSON.stringify(tasks));
    }

    function showTasks() {
      var list = document.getElementById("taskList");
      list.innerHTML = "";

      for (var i = 0; i < tasks.length; i++) {
        var task = tasks[i];
        var li = document.createElement("li");

        var text = document.createElement("div");
        text.textContent = task.title + " - " + new Date(task.time).toLocaleString();
        li.appendChild(text);

        var btnDiv = document.createElement("div");
        btnDiv.className = "actions";

        var deleteBtn = document.createElement("button");
        deleteBtn.textContent = "‚ùå Delete";
        deleteBtn.onclick = (function(index) {
          return function() {
            tasks.splice(index, 1);
            saveTasks();
            showTasks();
          };
        })(i);

        var editBtn = document.createElement("button");
        editBtn.textContent = "‚úèÔ∏è Edit";
        editBtn.onclick = (function(index) {
          return function() {
            var newTitle = prompt("Edit task title:", tasks[index].title);
            var newTime = prompt("Edit date/time (YYYY-MM-DDTHH:MM):", tasks[index].time);
            if (newTitle && newTime) {
              tasks[index].title = newTitle;
              tasks[index].time = newTime;
              tasks[index].notified = false;
              saveTasks();
              showTasks();
            }
          };
        })(i);

        btnDiv.appendChild(editBtn);
        btnDiv.appendChild(deleteBtn);
        li.appendChild(btnDiv);

        list.appendChild(li);
      }
    }

    function addTask() {
      var title = document.getElementById("taskInput").value;
      var time = document.getElementById("timeInput").value;

      if (title === "" || time === "") {
        alert("Please enter both task and time.");
        return;
      }

      tasks.push({ title: title, time: time, notified: false });
      saveTasks();
      showTasks();

      document.getElementById("taskInput").value = "";
      document.getElementById("timeInput").value = "";

      // Try play sound once to unlock browser autoplay
      document.getElementById("alarmSound").play().catch(() => {});
    }

    // Check tasks every 10 seconds
    setInterval(function() {
      var now = new Date();

      for (var i = 0; i < tasks.length; i++) {
        var taskTime = new Date(tasks[i].time);

        if (now >= taskTime && !tasks[i].notified) {
          tasks[i].notified = true;
          alert("üîî Time to start: " + tasks[i].title);
          document.getElementById("alarmSound").play();
          saveTasks();
        }
      }
    }, 10000);

    showTasks();
  </script>

</body>
</html>
